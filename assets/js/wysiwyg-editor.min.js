!function(a){"use strict";if("function"==typeof define&&define.amd)define(["jquery"],function(b){return a(window,document,b)});else{if("undefined"==typeof exports)return a(window,document,jQuery);module.exports=a(window,document,require("jquery"))}}(function(a,b,c){"use strict";var d=function(a,b,c){var d,e,f,g,h,i,j,k;switch(g=Math.floor(6*a),h=6*a-g,i=c*(1-b),j=c*(1-h*b),k=c*(1-(1-h)*b),g%6){case 0:d=c,e=k,f=i;break;case 1:d=j,e=c,f=i;break;case 2:d=i,e=c,f=k;break;case 3:d=i,e=j,f=c;break;case 4:d=k,e=i,f=c;break;case 5:d=c,e=i,f=j}var l=Math.floor(255*d).toString(16),m=Math.floor(255*e).toString(16),n=Math.floor(255*f).toString(16);return"#"+(l.length<2?"0":"")+l+(m.length<2?"0":"")+m+(n.length<2?"0":"")+n},e=function(a){return a.replace(/[&<>"]/g,function(a){var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};return b[a]||a})},f=function(f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){var x=function(a,b){var c='<a href="'+e(b)+'" target="_blank">'+e(b)+"</a>";b&&(a.getSelectedHTML()?a.insertHTML(c):a.insertHTML(c)),a.closePopup().collapseSelection()},y=function(a,b){var d=c('<input type="text" value="">').val(b?b.attr("href"):"").addClass("wysiwyg-input").keypress(function(c){10!=c.which&&13!=c.which||(b?(b.prop("href",d.val()),a.closePopup().collapseSelection()):x(a,d.val()))});m&&d.prop("placeholder",m);var e=c();k&&(e=D(k).click(function(c){return b?(b.prop("href",d.val()),a.closePopup().collapseSelection()):x(a,d.val()),c.stopPropagation(),c.preventDefault(),!1}));var f=c("<div/>").addClass("wysiwyg-toolbar-form").prop("unselectable","on");return f.append(d).append(e),f},z=function(b){var d=function(a,d){var f='<img id="wysiwyg-insert-image" src="" alt=""'+(d?' title="'+e(d)+'"':"")+">";b.insertHTML(f).closePopup().collapseSelection();var g=c("#wysiwyg-insert-image").removeAttr("id");o&&g.css({maxWidth:o[0]+"px",maxHeight:o[1]+"px"}).load(function(){g.css({maxWidth:"",maxHeight:""});var a=g.width(),b=g.height();(a>o[0]||b>o[1])&&(a/b>o[0]/o[1]?(b=parseInt(b/a*o[0]),a=o[0]):(a=parseInt(a/b*o[1]),b=o[1]),g.prop("width",a).prop("height",b))}),g.prop("src",a)},f=c("<div/>").addClass("wysiwyg-toolbar-form").prop("unselectable","on"),g=null,h=c('<input type="file">').css({position:"absolute",left:0,top:0,width:"100%",height:"100%",opacity:0,cursor:"pointer"});if(!r&&a.File&&a.FileReader&&a.FileList){var i=function(a){if(("function"!=typeof p||p(a))&&a.type.match(p)){var b=new FileReader;b.onload=function(b){var c=b.target.result;d(c,a.name)},b.readAsDataURL(a)}};g=h.prop("draggable","true").change(function(a){for(var b=a.target.files,c=0;c<b.length;++c)i(b[c])}).on("dragover",function(a){return a.originalEvent.dataTransfer.dropEffect="copy",a.stopPropagation(),a.preventDefault(),!1}).on("drop",function(a){for(var b=a.originalEvent.dataTransfer.files,c=0;c<b.length;++c)i(b[c]);return a.stopPropagation(),a.preventDefault(),!1})}else if(q){var j=h.change(function(a){q.call(this,d)});g=c("<form/>").append(j)}g&&c("<div/>").addClass("wysiwyg-browse").html(l).append(g).appendTo(f);var n=c('<input type="text" value="">').addClass("wysiwyg-input").keypress(function(a){10!=a.which&&13!=a.which||d(n.val())});m&&n.prop("placeholder",m);var s=c();return k&&(s=D(k).click(function(a){return d(n.val()),a.stopPropagation(),a.preventDefault(),!1})),f.append(c("<div/>").append(n).append(s)),f},A=function(a){var b=function(b,d){b=c.trim(b||""),d=c.trim(d||"");var f=!1;b.length&&!d.length?f=b:d.indexOf("<")==-1&&d.indexOf(">")==-1&&d.match(/^(?:https?:\/)?\/?(?:[^:\/\s]+)(?:(?:\/\w+)*\/)(?:[\w\-\.]+[^#?\s]+)(?:.*)?(?:#[\w\-]+)?$/)&&(f=d),f&&s&&(d=s(f)||""),!d.length&&f&&(d='<video src="'+e(f)+'">'),a.insertHTML(d).closePopup().collapseSelection()},d=c("<div/>").addClass("wysiwyg-toolbar-form").prop("unselectable","on"),f=c("<textarea>").addClass("wysiwyg-input wysiwyg-inputtextarea");n&&f.prop("placeholder",n),c("<div/>").addClass("wysiwyg-embedcode").append(f).appendTo(d);var g=c('<input type="text" value="">').addClass("wysiwyg-input").keypress(function(a){10!=a.which&&13!=a.which||b(g.val())});m&&g.prop("placeholder",m);var h=c();return k&&(h=D(k).click(function(a){return b(g.val(),f.val()),a.stopPropagation(),a.preventDefault(),!1})),d.append(c("<div/>").append(g).append(h)),d},B=function(a,b){for(var e=c("<table/>").prop("cellpadding","0").prop("cellspacing","0").prop("unselectable","on"),f=1;f<15;++f){for(var g=c("<tr/>"),h=0;h<25;++h){var i;if(24==h){var j=Math.floor(255/13*(14-f)).toString(16),k=(j.length<2?"0":"")+j;i="#"+k+k+k}else{var l=h/24,m=f<=8?f/8:1,n=f>8?(16-f)/8:1;i=d(l,m,n)}c("<td/>").addClass("wysiwyg-toolbar-color").prop("title",i).prop("unselectable","on").css({backgroundColor:i}).click(function(){var c=this.title;return b?a.forecolor(c).closePopup().collapseSelection():a.highlight(c).closePopup().collapseSelection(),!1}).appendTo(g)}e.append(g)}return e},C=function(a,b){switch(a){case"insertimage":return b?function(a){b(z(N),a)}:null;case"insertvideo":return b?function(a){b(A(N),a)}:null;case"insertlink":return b?function(a){b(y(N),a)}:null;case"bold":return function(){N.bold()};case"italic":return function(){N.italic()};case"underline":return function(){N.underline()};case"strikethrough":return function(){N.strikethrough()};case"forecolor":return b?function(a){b(B(N,!0),a)}:null;case"highlight":return b?function(a){b(B(N,!1),a)}:null;case"alignleft":return function(){N.align("left")};case"aligncenter":return function(){N.align("center")};case"alignright":return function(){N.align("right")};case"alignjustify":return function(){N.align("justify")};case"subscript":return function(){N.subscript()};case"superscript":return function(){N.superscript()};case"indent":return function(){N.indent()};case"outdent":return function(){N.indent(!0)};case"orderedList":return function(){N.insertList(!0)};case"unorderedList":return function(){N.insertList()};case"removeformat":return function(){N.removeFormat().closePopup().collapseSelection()}}return null},D=function(a){var b=c("<a/>").addClass("wysiwyg-toolbar-icon").prop("href","#").prop("unselectable","on").append(a.image);return c.each(a,function(a,c){switch(a){case"class":b.addClass(c);break;case"image":case"html":case"popup":case"click":case"showstatic":case"showselection":break;default:b.attr(a,c)}}),b},E=function(a,b,d,e){c.each(j,function(f,g){if(g&&(!(b===!1&&"showstatic"in g)||g.showstatic)&&(!(b===!0&&"showselection"in g)||g.showselection)){var h;h="click"in g?function(a){g.click(c(a))}:"popup"in g?function(a){var b=d(),f=g.popup(b,c(a));e(b,a,f)}:C(f,function(a,b){var c=d();c.append(a),e(c,b),c.find("input[type=text]:first").focus()});var i;h?i=D(g).click(function(a){return h(a.currentTarget),C(f)&&N.getElement().focus(),a.stopPropagation(),a.preventDefault(),!1}):g.html&&(i=c(g.html)),i&&a.append(i)}})},F=function(d,e,f,g){for(var h=e.get(0),i=h.offsetParent,j=0,k=0,l=!1,m=0,n=0,o=!1,p=!1,q=d.width(),r=i;r;){m+=r.offsetLeft,n+=r.offsetTop;var s=c(r),t=s.css("position");"static"!=t?l=!0:l||(j+=r.offsetLeft,k+=r.offsetTop),"fixed"==t&&(o=!0),"visible"!=s.css("overflow")&&(p=!0),r=r.offsetParent}var u=c(i||b.body);u.append(d),f+=j+h.offsetLeft,g+=k+h.offsetTop,(o||p)&&(f+q>u.width()-1&&(f=u.width()-q-1),f<1&&(f=1));var v=c(a).width();m+f+q>v-1&&(f=v-m-q-1);var w=o?0:c(a).scrollLeft();m+f<w+1&&(f=w-m+1),d.css({left:parseInt(f)+"px",top:parseInt(g)+"px"})},G={},H=null,I=function(a,b,d,e){var f=function(a,b,d,e,f,g,i){if(w){var j=H||"";switch(b){case 8:j=j.substring(0,j.length-1);case 13:case 27:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:if(a)return;d=!1;break;default:if(!a)return;j+=d}var k=w(j,b,d,e,f,g,i);if("object"!=typeof k||!k.length)return h.closePopup(),H=null,k;var l=c(h.openPopup());l.hide().addClass("wysiwyg-popup wysiwyg-popuphover").empty().append(k),H=j}},g={element:a.get(0),contenteditable:b?b.get(0):null,onKeyDown:function(a,b,c,d,e,g){if(t&&t(a,b,c,d,e,g)===!1)return!1;if(b&&!c&&!d&&e&&!g){var h=b.toLowerCase();if(!G[h])return;return G[h](),!1}return f(!1,a,b,c,d,e,g)},onKeyPress:function(a,b,c,d,e,g){return(!u||u(a,b,c,d,e,g)!==!1)&&f(!0,a,b,c,d,e,g)},onKeyUp:function(a,b,c,d,e,f){if(v&&v(a,b,c,d,e,f)===!1)return!1},onSelection:function(b,d,e,f){var g=!0,j=null;if(b&&c.each(e,function(a,b){var d=c(b).closest("a");if(0!=d.length)return j=y(h,d),!1}),h.readOnly()?g=!1:d?j||f||H||(c.inArray("selection",i.split("-"))==-1?g=!1:b?g=!1:1==e.length&&"IMG"==e[0].nodeName&&(g=!1)):g=!1,!g)return void h.closePopup();var k,l=function(){var b=k.outerWidth(),e=a.parent(),f=e.offset(),g=c(h.getElement()).offset(),i=d.left+parseInt(d.width/2)-parseInt(b/2)+g.left-f.left,j=d.top+d.height+g.top-f.top;F(k,e,i,j)};k=c(h.openPopup()),k.hasClass("wysiwyg-popuphover")&&!k.data("wysiwygjs-special")==!j||(k=c(h.closePopup().openPopup())),H?k.show():k.hasClass("wysiwyg-popup")||(k.addClass("wysiwyg-popup wysiwyg-popuphover"),j?k.empty().append(j).data("wysiwygjs-special",!0):E(k,!0,function(){return k.empty()},l)),l()},onOpenpopup:function(){Q()},onClosepopup:function(){H=null,R()},hijackContextmenu:"selection"==i,readOnly:!!a.prop("readonly")};e&&(g.onPlaceholder=function(a){a?e.show():e.hide()});var h=wysiwyg(g);return h},J=f.closest(".wysiwyg-container");0==J.length&&(J=c("<div/>").addClass("wysiwyg-container"),g&&J.addClass(g),f.wrap(J),J=f.closest(".wysiwyg-container"));var K=f.closest(".wysiwyg-wrapper");h&&0==K.length&&(K=c("<div/>").addClass("wysiwyg-wrapper"),f.wrap(K),K=f.closest(".wysiwyg-wrapper"));var L=null;0!=K.length&&(L=K.find(".wysiwyg-placeholder")),!h||L&&0!=L.length||(L=c("<div/>").addClass("wysiwyg-placeholder").html(h).hide(),K.prepend(L));var M=J.find(".wysiwyg-editor");0==M.length&&(M=null);var N=I(f,M,J,L);if(N.legacy){M&&M.hide(),L&&L.hide();var f=c(N.getElement());f.show().addClass("wysiwyg-textarea"),f.is(":visible")&&f.width(J.width()-(f.outerWidth()-f.width()))}else{M||c(N.getElement()).addClass("wysiwyg-editor"),K.click(function(){N.getElement().focus()});var O=null,P=null,Q=function(){O&&clearTimeout(O),O=null,P&&(P(),P=null),J.addClass("wysiwyg-active"),J.find(".wysiwyg-toolbar-focus").slideDown(200)},R=function(){O||b.activeElement==N.getElement()||(O=setTimeout(function(){O=null,J.removeClass("wysiwyg-active"),0==c.trim(N.getHTML().replace(/<br\s*[\/]?>/gi,"")).length&&J.find(".wysiwyg-toolbar-focus").slideUp(200)},100))};c(N.getElement()).focus(Q).blur(R),f.closest("form").on("reset",R);var S={};if(c.each(j,function(a,b){if(b&&b.hotkey){var c=C(a);c&&(G[b.hotkey.toLowerCase()]=c,S[a]=c)}}),!c.isEmptyObject(j)&&"selection"!=i){var T=c.inArray("top",i.split("-"))!=-1,U=c.inArray("focus",i.split("-"))!=-1,V=function(){var a=c("<div/>").addClass("wysiwyg-toolbar").addClass(T?"wysiwyg-toolbar-top":"wysiwyg-toolbar-bottom");U&&a.hide().addClass("wysiwyg-toolbar-focus"),E(a,!1,function(){var a=c(N.openPopup());return a.hasClass("wysiwyg-popup")&&a.hasClass("wysiwyg-popuphover")&&(a=c(N.closePopup().openPopup())),a.hasClass("wysiwyg-popup")||a.addClass("wysiwyg-popup"),a},function(a,b,d){var e=c(b),f=a.outerWidth(),g=e.offset().left-J.offset().left+parseInt(e.width()/2)-parseInt(f/2),h=e.offset().top-J.offset().top;T?h+=e.outerHeight():h-=a.outerHeight(),d&&(g=d.left,h=d.top),F(a,J,g,h)}),T?J.prepend(a):J.append(a)};U?P=V:V()}}return{wysiwygeditor:N,$container:J}};c.fn.wysiwyg=function(a,b){if(!a||"object"==typeof a)return a=c.extend({},a),this.each(function(){var b=c(this);if(!b.data("wysiwygjs")){var d=a.class,e=a.placeholder||b.prop("placeholder"),g=a.toolbar||"top",h=a.buttons||{},i=a.submit,j=a.selectImage,k=a.placeholderUrl||null,l=a.placeholderEmbed||null,m=a.maxImageSize||null,n=a.filterImageType||"^image/",o=a.onImageUpload||null,p=a.forceImageUpload&&o,q=a.videoFromUrl||null,r=a.onKeyDown||null,s=a.onKeyPress||null,t=a.onKeyUp||null,u=a.onAutocomplete||null,v=f(b,d,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u);b.data("wysiwygjs",v)}});if(1==this.length){var d=this.data("wysiwygjs");if(!d)return this;if("container"==a)return d.$container;if("shell"==a)return d.wysiwygeditor}return this}});